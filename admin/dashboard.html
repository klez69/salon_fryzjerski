<!DOCTYPE html>
<html lang="pl">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Panel Administracyjny - Salon Kosmetyczny</title>
		<link
			href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
			rel="stylesheet"
		/>
		<link rel="stylesheet" href="admin-style.css" />
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css" />
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.css" />
		<script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		<style>
			@media (max-width: 768px) {
				body {
					display: block !important;
				}

				.main-content {
					margin-left: 0 !important;
					width: 100% !important;
					padding: 15px !important;
				}

				/* Ukryj wszystkie elementy poza rezerwacjami i kalendarzem na urządzeniach mobilnych */
				.stats-cards,
				.content-block:not(#calendar-block):not(#reservations-block) {
					display: none !important;
				}

				/* Zawsze wyświetlaj kalendarz i rezerwacje */
				#calendar-block,
				#reservations-block {
					display: block !important;
				}

				/* Pokaż przycisk menu na urządzeniach mobilnych */
				.mobile-menu-toggle {
					display: block;
					position: fixed;
					top: 15px;
					left: 15px;
					z-index: 1001;
					background-color: var(--purple);
					color: white;
					border: none;
					width: 40px;
					height: 40px;
					border-radius: 5px;
					display: flex;
					align-items: center;
					justify-content: center;
					cursor: pointer;
					box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
				}
			}
		</style>
	</head>
	<body>
		<!-- Przycisk menu mobilnego -->
		<button id="mobile-menu-toggle" class="mobile-menu-toggle">
			<i class="fas fa-bars"></i>
		</button>

		<!-- Tło przyciemniające dla menu mobilnego -->
		<div class="menu-backdrop"></div>

		<!-- Sidebar -->
		<div class="sidebar">
			<div class="sidebar-header">
				<div class="logo">
					<i class="fas fa-spa"></i>
					<h2>Nail Salon</h2>
				</div>
				<button id="sidebarToggle" class="sidebar-toggle">
					<i class="fas fa-times"></i>
				</button>
			</div>

			<nav class="sidebar-nav">
				<ul>
					<li class="active">
						<a href="#dashboard"><i class="fas fa-tachometer-alt"></i> Pulpit</a>
					</li>
					<li>
						<a href="#reservations"><i class="fas fa-calendar-alt"></i> Rezerwacje</a>
					</li>
					<li>
						<a href="#clients"><i class="fas fa-users"></i> Klienci</a>
					</li>
					<li>
						<a href="#services"><i class="fas fa-clipboard-list"></i> Usługi</a>
					</li>
					<li>
						<a href="#analytics"><i class="fas fa-chart-bar"></i> Statystyki</a>
					</li>
					<li>
						<a href="#settings"><i class="fas fa-cog"></i> Ustawienia</a>
					</li>
				</ul>
			</nav>

			<div class="sidebar-footer">
				<a href="../nail-salon-template.html" target="_blank"
					><i class="fas fa-external-link-alt"></i> Przejdź do strony głównej</a
				>
			</div>

			<button id="logout-btn"><i class="fas fa-sign-out-alt"></i> Wyloguj się</button>
		</div>

		<main class="main-content">
			<div class="page-header">
				<h1>Pulpit</h1>
				<button class="action-btn" onclick="showModal('appointment-modal')">
					<i class="fas fa-plus"></i> Nowa rezerwacja
				</button>
			</div>

			<!-- Sekcja rezerwacji - zawsze widoczna na urządzeniach mobilnych -->
			<div class="content-block" id="reservations-block">
				<div class="section-title">Rezerwacje</div>
				<div class="tabs">
					<div class="tab active" data-tab="today">Dzisiejsze rezerwacje</div>
					<div class="tab" data-tab="upcoming">Nadchodzące</div>
					<div class="tab" data-tab="all">Wszystkie</div>
				</div>

				<div class="tab-content active" id="today-tab">
					<ul class="recent-list">
						<li class="recent-item">
							<div class="recent-avatar">AK</div>
							<div class="recent-details">
								<div class="recent-name">Anna Kowalska</div>
								<div class="recent-info">Manicure Hybrydowy - 10:00</div>
							</div>
							<span class="recent-status status-confirmed">Potwierdzona</span>
						</li>
						<li class="recent-item">
							<div class="recent-avatar">MN</div>
							<div class="recent-details">
								<div class="recent-name">Monika Nowak</div>
								<div class="recent-info">Pedicure - 11:30</div>
							</div>
							<span class="recent-status status-confirmed">Potwierdzona</span>
						</li>
						<li class="recent-item">
							<div class="recent-avatar">KW</div>
							<div class="recent-details">
								<div class="recent-name">Katarzyna Wiśniewska</div>
								<div class="recent-info">Manicure Klasyczny - 13:00</div>
							</div>
							<span class="recent-status status-pending">Oczekująca</span>
						</li>
						<li class="recent-item">
							<div class="recent-avatar">JL</div>
							<div class="recent-details">
								<div class="recent-name">Joanna Lis</div>
								<div class="recent-info">Przedłużanie paznokci - 15:30</div>
							</div>
							<span class="recent-status status-canceled">Anulowana</span>
						</li>
						<li class="recent-item">
							<div class="recent-avatar">BP</div>
							<div class="recent-details">
								<div class="recent-name">Barbara Pawlak</div>
								<div class="recent-info">Manicure Hybrydowy - 17:00</div>
							</div>
							<span class="recent-status status-confirmed">Potwierdzona</span>
						</li>
					</ul>
				</div>

				<div class="tab-content" id="upcoming-tab">
					<ul class="recent-list">
						<li class="recent-item">
							<div class="recent-avatar">ES</div>
							<div class="recent-details">
								<div class="recent-name">Ewa Sikora</div>
								<div class="recent-info">Manicure Hybrydowy - Jutro, 9:00</div>
							</div>
							<span class="recent-status status-confirmed">Potwierdzona</span>
						</li>
						<li class="recent-item">
							<div class="recent-avatar">ZR</div>
							<div class="recent-details">
								<div class="recent-name">Zofia Rutkowska</div>
								<div class="recent-info">Pedicure - Jutro, 12:30</div>
							</div>
							<span class="recent-status status-pending">Oczekująca</span>
						</li>
						<li class="recent-item">
							<div class="recent-avatar">MD</div>
							<div class="recent-details">
								<div class="recent-name">Magdalena Dąbrowska</div>
								<div class="recent-info">Manicure Klasyczny - 25.06, 14:00</div>
							</div>
							<span class="recent-status status-confirmed">Potwierdzona</span>
						</li>
					</ul>
				</div>

				<div class="tab-content" id="all-tab">
					<div style="padding: 20px; text-align: center; color: #777">
						Wszystkie rezerwacje dostępne są w sekcji Kalendarz.
					</div>
				</div>
			</div>

			<!-- W wersji desktopowej pokazujemy statystyki -->
			<div class="stats-cards">
				<div class="stat-card">
					<div class="stat-icon">
						<i class="fas fa-calendar-check"></i>
					</div>
					<div class="stat-info">
						<div class="stat-number">24</div>
						<div class="stat-label">Dzisiejsze rezerwacje</div>
					</div>
				</div>

				<div class="stat-card">
					<div class="stat-icon">
						<i class="fas fa-users"></i>
					</div>
					<div class="stat-info">
						<div class="stat-number">1,523</div>
						<div class="stat-label">Stałych klientów</div>
					</div>
				</div>

				<div class="stat-card">
					<div class="stat-icon">
						<i class="fas fa-chart-line"></i>
					</div>
					<div class="stat-info">
						<div class="stat-number">14,269</div>
						<div class="stat-label">Miesięczne odwiedziny strony</div>
					</div>
				</div>

				<div class="stat-card">
					<div class="stat-icon">
						<i class="fas fa-star"></i>
					</div>
					<div class="stat-info">
						<div class="stat-number">4.9</div>
						<div class="stat-label">Średnia ocena (78 opinii)</div>
					</div>
				</div>
			</div>

			<div class="grid-row">
				<div class="content-block">
					<div class="section-title">Ruch na stronie (ostatnie 7 dni)</div>
					<div class="chart-container">
						<canvas id="visitors-chart"></canvas>
					</div>
					<div class="chart-legend">
						<div class="legend-item">
							<div class="legend-color" style="background-color: rgba(159, 122, 234, 0.7)"></div>
							<span>Odwiedziny</span>
						</div>
						<div class="legend-item">
							<div class="legend-color" style="background-color: rgba(255, 154, 200, 0.7)"></div>
							<span>Rezerwacje online</span>
						</div>
					</div>
				</div>
			</div>

			<!-- Kalendarz - zawsze widoczny na urządzeniach mobilnych -->
			<div class="content-block" id="calendar-block">
				<div class="section-title">Kalendarz rezerwacji</div>
				<div id="calendar" class="calendar-container"></div>
			</div>

			<div class="content-block" id="stats-block" style="display: none">
				<div class="section-title">Statystyki odwiedzin</div>
				<div class="grid-row">
					<div class="chart-container">
						<canvas id="monthly-visitors-chart"></canvas>
					</div>
					<div class="chart-container">
						<canvas id="traffic-sources-chart"></canvas>
					</div>
				</div>

				<div class="section-title" style="margin-top: 30px">Popularne strony</div>
				<ul class="recent-list">
					<li class="recent-item">
						<div class="recent-avatar"><i class="fas fa-file"></i></div>
						<div class="recent-details">
							<div class="recent-name">Strona główna</div>
							<div class="recent-info">8,452 odwiedzin</div>
						</div>
					</li>
					<li class="recent-item">
						<div class="recent-avatar"><i class="fas fa-file"></i></div>
						<div class="recent-details">
							<div class="recent-name">Manicure Hybrydowy</div>
							<div class="recent-info">3,129 odwiedzin</div>
						</div>
					</li>
					<li class="recent-item">
						<div class="recent-avatar"><i class="fas fa-file"></i></div>
						<div class="recent-details">
							<div class="recent-name">Kontakt</div>
							<div class="recent-info">2,845 odwiedzin</div>
						</div>
					</li>
					<li class="recent-item">
						<div class="recent-avatar"><i class="fas fa-file"></i></div>
						<div class="recent-details">
							<div class="recent-name">Galeria</div>
							<div class="recent-info">2,156 odwiedzin</div>
						</div>
					</li>
				</ul>
			</div>
		</main>

		<!-- Modal nowej rezerwacji -->
		<div id="appointment-modal" class="modal">
			<div class="modal-content">
				<div class="modal-close" onclick="hideModal('appointment-modal')">
					<i class="fas fa-times"></i>
				</div>
				<div class="modal-title">Nowa rezerwacja</div>
				<form class="modal-form">
					<div class="form-group">
						<label for="client-name">Imię i nazwisko klienta</label>
						<input type="text" id="client-name" class="form-control" required />
					</div>

					<div class="form-row">
						<div class="form-group">
							<label for="client-phone">Telefon</label>
							<input type="tel" id="client-phone" class="form-control" required />
						</div>

						<div class="form-group">
							<label for="client-email">Email</label>
							<input type="email" id="client-email" class="form-control" />
						</div>
					</div>

					<div class="form-group">
						<label for="service-type">Usługa</label>
						<select id="service-type" class="form-control" required>
							<option value="">Wybierz usługę</option>
							<option value="manicure-classic">Manicure Klasyczny</option>
							<option value="manicure-hybrid">Manicure Hybrydowy</option>
							<option value="pedicure">Pedicure</option>
							<option value="nail-art">Zdobienia</option>
							<option value="nail-extension">Przedłużanie paznokci</option>
						</select>
					</div>

					<div class="form-row">
						<div class="form-group">
							<label for="appointment-date">Data</label>
							<input type="date" id="appointment-date" class="form-control" required />
						</div>

						<div class="form-group">
							<label for="appointment-time">Godzina</label>
							<input type="time" id="appointment-time" class="form-control" required />
						</div>
					</div>

					<div class="form-group">
						<label for="appointment-notes">Uwagi</label>
						<textarea id="appointment-notes" class="form-control" rows="3"></textarea>
					</div>

					<button type="submit" class="action-btn">Zapisz rezerwację</button>
				</form>
			</div>
		</div>

		<!-- Powiadomienia -->
		<div id="notification" class="notification">
			<i class="fas fa-check-circle"></i>
			<span id="notification-message">Zalogowano pomyślnie!</span>
		</div>

		<!-- Skrypty -->
		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.js"></script>

		<script>
			// Funkcja do przełączania menu mobilnego
			function toggleMenu() {
				const sidebar = document.querySelector('.sidebar')
				const backdrop = document.querySelector('.menu-backdrop')
				const body = document.body

				sidebar.classList.toggle('active')
				backdrop.classList.toggle('active')
				body.classList.toggle('menu-open')
			}

			// Obsługa kliknięcia przycisku menu
			document.getElementById('mobile-menu-toggle').addEventListener('click', toggleMenu)

			// Obsługa kliknięcia tła menu
			document.querySelector('.menu-backdrop').addEventListener('click', toggleMenu)

			// Sprawdzanie, czy użytkownik jest zalogowany
			window.onload = function () {
				const isLoggedIn = localStorage.getItem('adminLoggedIn') === 'true'
				if (!isLoggedIn) {
					console.log('Użytkownik nie jest zalogowany, przekierowuję do strony logowania')
					window.location.href = 'login.html'
				} else {
					console.log('Użytkownik zalogowany, wyświetlam panel')
					document.body.style.display = 'block'
				}
			}

			// Dodaj obsługę wylogowania - używamy JEDNEGO spójnego klucza
			document.addEventListener('DOMContentLoaded', function () {
				// Obsługuj przycisk wylogowania
				const logoutBtn = document.getElementById('logout-btn')
				if (logoutBtn) {
					logoutBtn.addEventListener('click', function () {
						localStorage.removeItem('adminLoggedIn')
						window.location.href = 'login.html'
					})
				}

				// Obsługa przełączania menu na urządzeniach mobilnych
				const mobileMenuToggle = document.getElementById('mobile-menu-toggle')
				const sidebarToggle = document.getElementById('sidebarToggle')
				const sidebar = document.querySelector('.sidebar')
				const menuBackdrop = document.querySelector('.menu-backdrop')

				// Funkcja przełączająca menu
				function toggleMenu() {
					sidebar.classList.toggle('active')
					menuBackdrop.classList.toggle('active')
					document.body.classList.toggle('menu-open')
				}

				// Dodaj event listenery do przycisków
				if (mobileMenuToggle) {
					mobileMenuToggle.addEventListener('click', toggleMenu)
				}

				if (sidebarToggle) {
					sidebarToggle.addEventListener('click', toggleMenu)
				}

				if (menuBackdrop) {
					menuBackdrop.addEventListener('click', toggleMenu)
				}

				// Obsługuj linki do wylogowania
				const logoutLinks = document.querySelectorAll("a[href='login.html']")
				logoutLinks.forEach(link => {
					link.addEventListener('click', function (e) {
						localStorage.removeItem('adminLoggedIn')
						console.log('Wylogowanie')
					})
				})

				// Sprawdzenie logowania
				if (!localStorage.getItem('adminLoggedIn')) {
					// Przekieruj do strony logowania jeśli użytkownik nie jest zalogowany
					window.location.href = 'login.html'
					return
				}

				// Pokaż powiadomienie o zalogowaniu
				showNotification('Zalogowano pomyślnie!')

				// Inicjalizacja kalendarza
				initCalendar()

				// Inicjalizacja wykresów
				initCharts()

				// Obsługa przełączania zakładek
				document.querySelectorAll('.tab').forEach(tab => {
					tab.addEventListener('click', function () {
						const tabId = this.getAttribute('data-tab')

						// Usuń klasę active ze wszystkich zakładek
						document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'))
						document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'))

						// Dodaj klasę active do wybranej zakładki
						this.classList.add('active')
						document.getElementById(tabId + '-tab').classList.add('active')
					})
				})

				// Obsługa formularza nowej rezerwacji
				document.querySelector('.modal-form').addEventListener('submit', function (e) {
					e.preventDefault()
					hideModal('appointment-modal')
					showNotification('Rezerwacja została dodana!')
				})
			})

			// Funkcja inicjalizująca kalendarz
			function initCalendar() {
				const calendarEl = document.getElementById('calendar')
				const calendar = new FullCalendar.Calendar(calendarEl, {
					initialView: 'dayGridMonth',
					locale: 'pl',
					headerToolbar: {
						left: 'prev,next today',
						center: 'title',
						right: 'dayGridMonth,timeGridWeek,timeGridDay',
					},
					events: [
						{
							title: 'Anna Kowalska - Manicure Hybrydowy',
							start: '2023-06-15T10:00:00',
							end: '2023-06-15T11:00:00',
							backgroundColor: '#9f7aea',
						},
						{
							title: 'Monika Nowak - Pedicure',
							start: '2023-06-15T11:30:00',
							end: '2023-06-15T13:00:00',
							backgroundColor: '#9f7aea',
						},
						{
							title: 'Katarzyna Wiśniewska - Manicure Klasyczny',
							start: '2023-06-15T13:00:00',
							end: '2023-06-15T14:00:00',
							backgroundColor: '#9f7aea',
						},
						{
							title: 'Joanna Lis - Przedłużanie paznokci',
							start: '2023-06-15T15:30:00',
							end: '2023-06-15T17:00:00',
							backgroundColor: '#e53e3e',
							textColor: 'white',
							extendedProps: {
								status: 'canceled',
							},
						},
						{
							title: 'Barbara Pawlak - Manicure Hybrydowy',
							start: '2023-06-15T17:00:00',
							end: '2023-06-15T18:00:00',
							backgroundColor: '#9f7aea',
						},
						{
							title: 'Ewa Sikora - Manicure Hybrydowy',
							start: '2023-06-16T09:00:00',
							end: '2023-06-16T10:00:00',
							backgroundColor: '#9f7aea',
						},
						{
							title: 'Zofia Rutkowska - Pedicure',
							start: '2023-06-16T12:30:00',
							end: '2023-06-16T14:00:00',
							backgroundColor: '#f6ad55',
							extendedProps: {
								status: 'pending',
							},
						},
						{
							title: 'Magdalena Dąbrowska - Manicure Klasyczny',
							start: '2023-06-25T14:00:00',
							end: '2023-06-25T15:00:00',
							backgroundColor: '#9f7aea',
						},
					],
					eventClick: function (info) {
						alert('Rezerwacja: ' + info.event.title)
					},
				})
				calendar.render()
			}

			// Funkcja inicjalizująca wykresy
			function initCharts() {
				// Wykres odwiedzin (ostatnie 7 dni)
				const visitorsCtx = document.getElementById('visitors-chart').getContext('2d')
				new Chart(visitorsCtx, {
					type: 'line',
					data: {
						labels: ['Pon', 'Wt', 'Śr', 'Czw', 'Pt', 'Sob', 'Ndz'],
						datasets: [
							{
								label: 'Odwiedziny',
								data: [1250, 1420, 1350, 1650, 2100, 1830, 1670],
								backgroundColor: 'rgba(159, 122, 234, 0.2)',
								borderColor: 'rgba(159, 122, 234, 1)',
								borderWidth: 2,
								tension: 0.4,
							},
							{
								label: 'Rezerwacje online',
								data: [45, 52, 48, 58, 72, 63, 55],
								backgroundColor: 'rgba(255, 154, 200, 0.2)',
								borderColor: 'rgba(255, 154, 200, 1)',
								borderWidth: 2,
								tension: 0.4,
							},
						],
					},
					options: {
						responsive: true,
						maintainAspectRatio: false,
						plugins: {
							legend: {
								display: false,
							},
						},
						scales: {
							y: {
								beginAtZero: true,
							},
						},
					},
				})

				// Wykres miesięcznych odwiedzin
				const monthlyVisitorsCtx = document.getElementById('monthly-visitors-chart').getContext('2d')
				new Chart(monthlyVisitorsCtx, {
					type: 'bar',
					data: {
						labels: ['Sty', 'Lut', 'Mar', 'Kwi', 'Maj', 'Cze'],
						datasets: [
							{
								label: 'Odwiedziny w 2023',
								data: [9800, 10200, 11500, 12800, 13900, 14200],
								backgroundColor: 'rgba(159, 122, 234, 0.7)',
							},
							{
								label: 'Odwiedziny w 2022',
								data: [8200, 8900, 9500, 10100, 11200, 11800],
								backgroundColor: 'rgba(159, 122, 234, 0.3)',
							},
						],
					},
					options: {
						responsive: true,
						maintainAspectRatio: false,
						plugins: {
							title: {
								display: true,
								text: 'Odwiedziny miesięczne',
							},
						},
					},
				})

				// Wykres źródeł ruchu
				const trafficSourcesCtx = document.getElementById('traffic-sources-chart').getContext('2d')
				new Chart(trafficSourcesCtx, {
					type: 'doughnut',
					data: {
						labels: ['Wyszukiwarki', 'Media społecznościowe', 'Bezpośrednie', 'Polecenia'],
						datasets: [
							{
								data: [45, 30, 15, 10],
								backgroundColor: [
									'rgba(159, 122, 234, 0.7)',
									'rgba(255, 154, 200, 0.7)',
									'rgba(56, 178, 172, 0.7)',
									'rgba(246, 173, 85, 0.7)',
								],
							},
						],
					},
					options: {
						responsive: true,
						maintainAspectRatio: false,
						plugins: {
							title: {
								display: true,
								text: 'Źródła ruchu',
							},
						},
					},
				})
			}

			// Funkcja wyświetlająca powiadomienie
			function showNotification(message) {
				const notification = document.getElementById('notification')
				const messageEl = document.getElementById('notification-message')

				messageEl.textContent = message
				notification.classList.add('show')

				setTimeout(() => {
					notification.classList.remove('show')
				}, 3000)
			}

			// Funkcja przełączająca widok zakładek
			function showTab(tabName) {
				// Ukryj wszystkie bloki zawartości
				document.querySelectorAll('.main-content > .content-block').forEach(block => {
					block.style.display = 'none'
				})

				// Pokaż kalendarz jeśli to zakładka kalendarza
				if (tabName === 'calendar') {
					document.getElementById('calendar-block').style.display = 'block'
				}
				// Pokaż rezerwacje
				else if (tabName === 'reservations') {
					document.getElementById('reservations-block').style.display = 'block'
				}
				// Pokaż statystyki jeśli to zakładka statystyk
				else if (tabName === 'stats') {
					document.getElementById('stats-block').style.display = 'block'
				}

				// Usuń klasę active ze wszystkich linków w menu
				document.querySelectorAll('.sidebar-nav a').forEach(link => {
					link.classList.remove('active')
				})

				// Dodaj klasę active do klikniętego linku
				document.querySelector(`.sidebar-nav a[onclick="showTab('${tabName}')"]`).classList.add('active')
			}

			// Funkcje obsługi modali
			function showModal(modalId) {
				document.getElementById(modalId).classList.add('show')
			}

			function hideModal(modalId) {
				document.getElementById(modalId).classList.remove('show')
			}
		</script>
	</body>
</html>
